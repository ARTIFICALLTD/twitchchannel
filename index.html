<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>OBS Video Player</title>
        <style>
            body {
                margin: 0;
                overflow: hidden;
                background: black;
                display: flex;
                align-items: center;
                justify-content: center;
                height: 100vh;
                width: 100vw; /* Yeni eklendi */
            }
            #waitingText {
                color: white;
                font-family: Arial, sans-serif;
                font-size: 32px;
                position: absolute;
            }
            #ytPlayer {
                display: none;
                border: none;
                margin: 0 auto; /* Yeni eklendi */
                position: relative; /* Yeni eklendi */
                left: 0; /* Yeni eklendi */
                transform: none; /* Yeni eklendi */
            }
            
            /* Yeni eklenen responsive container */
            #videoContainer {
                width: 100%;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                overflow: hidden;
            }
        </style>
    </head>
    <body>
        <div id="videoContainer">
            <div id="waitingText">Waiting for video...</div>
            <iframe 
                id="ytPlayer"
                width="1280" 
                height="720"
                frameborder="0"
                allow="autoplay; encrypted-media; picture-in-picture"
                allowfullscreen>
            </iframe>
        </div>

    <script>
        let currentVideoId = "";
        
        async function checkVideo() {
            try {
                const response = await fetch("https://gamerportsocketio3.onrender.com/current-video");
                const { video } = await response.json();
                
                if(!video) {
                    document.getElementById("ytPlayer").style.display = "none";
                    document.getElementById("waitingText").style.display = "block";
                    currentVideoId = ""; // Resetleme eklendi
                    return;
                }
    
                const videoId = new URL(video).searchParams.get("v");
                const player = document.getElementById("ytPlayer");
                
                // AynÄ± video bile olsa zorla yenile
                if(videoId !== currentVideoId || player.src === "about:blank") {
                    currentVideoId = videoId;
                    player.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=0&enablejsapi=1&origin=${window.location.origin}&controls=0&rel=0&${Date.now()}`;
                    
                    player.style.display = "block";
                    document.getElementById("waitingText").style.display = "none";
                    
                    setTimeout(() => {
                        player.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
                    }, 2000);
                }
    
            } catch(error) {
                console.error("Error:", error);
            }
        }
    
        setInterval(checkVideo, 2000);
        checkVideo();
    </script>
</body>
</html>
